
InsertObjectsFun = fun() ->
{ok, C} = riak:local_client(),
C:put(riak_object:new(<<"bucket-1">>, <<"key-1-c2">>, <<"value-1-c2">>)),
C:put(riak_object:new(<<"bucket-1">>, <<"key-2-c2">>, <<"value-2-c2">>)),
C:put(riak_object:new(<<"bucket-2">>, <<"key-1-c3">>, <<"value-1-c3">>)),
C:put(riak_object:new(<<"bucket-2">>, <<"key-2-c3">>, <<"value-2-c3">>)),

USDict = dict:from_list([{country_of_origin, 'us'}]),
UKDict = dict:from_list([{country_of_origin, 'uk'}]),

C:put(riak_object:new(<<"bucket-3">>, <<"key-1-c2">>, <<"value-1-c2">>, UKDict)),
C:put(riak_object:new(<<"bucket-3">>, <<"key-2-c2">>, <<"value-2-c2">>, UKDict)),
C:put(riak_object:new(<<"bucket-3">>, <<"key-1-c3">>, <<"value-1-c3">>, USDict)),
C:put(riak_object:new(<<"bucket-3">>, <<"key-2-c3">>, <<"value-2-c3">>, USDict))
end.

DeleteObjectsFun = fun() ->
{ok, C} = riak:local_client(),
C:delete(<<"bucket-1">>, <<"key-1-c2">>),
C:delete(<<"bucket-1">>, <<"key-2-c2">>),
C:delete(<<"bucket-2">>, <<"key-1-c3">>),
C:delete(<<"bucket-2">>, <<"key-2-c3">>),

C:delete(<<"bucket-3">>, <<"key-1-c2">>),
C:delete(<<"bucket-3">>, <<"key-2-c2">>),
C:delete(<<"bucket-3">>, <<"key-1-c3">>),
C:delete(<<"bucket-3">>, <<"key-2-c3">>)
end.


DeleteObjectsFun().
InsertObjectsFun().


ListKeysFun = fun() ->
{ok, C} = riak:local_client(),
F = fun(Bucket) ->
{ok, Keys} = C:list_keys(Bucket),
[{Bucket, Key} || Key <- Keys]
end,
BucketKeys = lists:flatten(lists:sort([F(Bucket) || Bucket <- [<<"bucket-1">>, <<"bucket-2">>, <<"bucket-3">>, <<"bucket-4">>, <<"bucket-5">>]]))
end.
BKs = ListKeysFun().
{ok, C} = riak:local_client().
[rp(C:get(Bucket, Key)) || {Bucket, Key} <- BKs].